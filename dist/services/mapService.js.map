{"version":3,"sources":["../../src/services/mapService.js"],"names":["mapService","width","height","tileWidth","tileHeight","map","Map","ctx","sprites","x","y","value","grid","min","Math","round","max","setGrid","parts","agd","building","garden","food","floor","console","log","sprite","redraw","drawImage","packages","store","length","position","package","li","document","createElement","appendChild","innerHTML","weight"],"mappings":"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","file":"mapService.js","sourcesContent":["import Map from '../models/map.js';\r\n\r\nexport default class mapService{\r\n    constructor(width, height, tileWidth, tileHeight){\r\n        this.map = new Map(width,height,tileWidth,tileHeight);\r\n        this.ctx = null;\r\n        this.sprites = null;\r\n    }\r\n\r\n    getWidth(){\r\n        return this.map.width * this.map.tileWidth;\r\n    }\r\n\r\n    getHeight(){\r\n        return this.map.height * this.map.tileHeight;\r\n    }\r\n\r\n    //update map\r\n    setGrid(x,y,value){\r\n        this.map.grid[x][y] = value;\r\n    }\r\n\r\n    //init map\r\n    init(){\r\n        let min = Math.round(this.map.width * 0.25);\r\n        let max = Math.round(this.map.height * 0.75) - 1;\r\n\r\n        for(var x=0; x < this.map.width; x++){\r\n            this.map.grid[x]= [];\r\n            for(var y=0;y < this.map.height; y++){\r\n                if(y > max){\r\n                    if(x < min)\r\n                        this.setGrid(x,y,this.map.parts.agd)\r\n                    else if(x < min*2)\r\n                        this.setGrid(x,y,this.map.parts.building)\r\n                    else if(x > max)\r\n                        this.setGrid(x,y,this.map.parts.garden)\r\n                    else\r\n                        this.setGrid(x,y,this.map.parts.food)\r\n                }\r\n                else\r\n                    this.setGrid(x,y,this.map.parts.floor)\r\n            }\r\n        }\r\n        console.log(this.map.grid)    \r\n        return this.map.grid;\r\n    }\r\n\r\n    //draw base map\r\n    drawMap(){\r\n        let sprite = null;\r\n\r\n        for(var x = 0; x < this.map.width; x++){\r\n            for(var y = 0; y < this.map.height; y++){\r\n                switch(this.map.grid[x][y]){\r\n                    case this.map.parts.food:\r\n                        sprite = this.map.parts.food;\r\n                        break;\r\n                    case this.map.parts.building:\r\n                        sprite = this.map.parts.building;\r\n                        break;\r\n                    case this.map.parts.agd:\r\n                        sprite = this.map.parts.agd;\r\n                        break;\r\n                    case this.map.parts.garden:\r\n                        sprite = this.map.parts.garden;\r\n                        break;\r\n                    default:\r\n                        sprite = this.map.parts.floor;\r\n                        break;\r\n                }\r\n                this.redraw(x,y,sprite);\r\n            }\r\n        }\r\n    }\r\n\r\n    //redraw point\r\n    redraw(x,y,sprite){\r\n        this.ctx.drawImage(\r\n            this.sprites,\r\n            sprite*this.map.tileWidth, 0,\r\n            this.map.tileWidth, this.map.tileHeight,\r\n            x*this.map.tileWidth,y*this.map.tileHeight,\r\n            this.map.tileWidth, this.map.tileHeight\r\n        );\r\n    }\r\n\r\n    //draw package\r\n    drawPackage(packages, store){\r\n        console.log(packages);\r\n\r\n        for(var x = 0; x < packages.length; x++){\r\n            this.setGrid(packages[x].position.x, packages[x].position.y, this.map.parts.package);\r\n            this.redraw(packages[x].position.x, packages[x].position.y, this.map.parts.package);\r\n\r\n            var li = document.createElement('li');\r\n            store.appendChild(li);\r\n\r\n            li.innerHTML += 'Package (' + \r\n            packages[x].width + 'x' + \r\n            packages[x].length + 'x' + \r\n            packages[x].height + ', ' +\r\n            packages[x].weight + ' kg' +\r\n            ' x: ' + packages[x].position.x + \r\n            ' y: ' + packages[x].position.y + ')';\r\n        }\r\n    }\r\n}"]}